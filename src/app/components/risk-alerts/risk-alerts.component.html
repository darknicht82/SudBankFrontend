<div class="card">
  <div class="card-header d-flex justify-content-between align-items-center">
    <h3>Alertas de Riesgo</h3>
    <button pButton 
            icon="pi pi-refresh" 
            class="p-button-rounded p-button-outlined"
            (click)="loadAlerts()"
            [disabled]="loading">
    </button>
  </div>
  <div class="card-body">
    <p-toast></p-toast>
    
    <p-table [value]="alerts" 
             [loading]="loading"
             [paginator]="true" 
             [rows]="10"
             [showCurrentPageReport]="true"
             currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords} alertas"
             [rowsPerPageOptions]="[10,25,50]">
      <ng-template pTemplate="header">
        <tr>
          <th>ID</th>
          <th>TÃ­tulo</th>
          <th>Severidad</th>
          <th>Estado</th>
          <th>Fecha</th>
          <th>Acciones</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-alert>
        <tr>
          <td>{{alert.id}}</td>
          <td>{{alert.title}}</td>
          <td>
            <span class="badge" [ngClass]="'bg-' + getSeverityClass(alert.level)">
              {{alert.level | titlecase}}
            </span>
          </td>
          <td>
            <span class="badge" [ngClass]="'bg-' + getAlertStatusClass(alert.status)">
              {{alert.status | titlecase}}
            </span>
          </td>
          <td>{{alert.createdAt | date:'short'}}</td>
          <td>
            <div class="btn-group">
              <button pButton 
                      icon="pi pi-check" 
                      class="p-button-rounded p-button-success p-button-outlined"
                      (click)="acknowledgeAlert(alert)"
                      [disabled]="alert.status !== 'ACTIVE'"
                      pTooltip="Reconocer">
              </button>
              <button pButton 
                      icon="pi pi-times" 
                      class="p-button-rounded p-button-danger p-button-outlined"
                      (click)="resolveAlert(alert)"
                      [disabled]="alert.status === 'RESOLVED'"
                      pTooltip="Resolver">
              </button>
            </div>
          </td>
        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="6" class="text-center">No hay alertas para mostrar</td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div> 