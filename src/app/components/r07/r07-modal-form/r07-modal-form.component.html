<!-- Modal del Formulario R07 -->
<div class="modal-overlay" *ngIf="isVisible" (click)="closeModal()">
  <div class="modal" (click)="$event.stopPropagation()">

    <!-- Header -->
    <div class="modal-header">
      <div class="header-content">
        <span class="operation-icon">游</span>
        <h3 class="modal-title">Crear Nuevo Registro R07</h3>
      </div>
      <button class="close-button" (click)="closeModal()" type="button">
        <span>&times;</span>
      </button>
    </div>

    <!-- Body -->
    <div class="modal-body">
      <form [formGroup]="r07Form" (ngSubmit)="onSubmit()" class="w-100">

        <!-- Secci칩n: Informaci칩n del Sujeto -->
        <h5 class="mt-3 mb-2 border-bottom pb-1">Informaci칩n del Sujeto</h5>
        <div class="row g-2">
          <!-- Tipo Identificaci칩n -->
          <div class="col-md-6">
            <label for="tipoIdentificacionSujeto" class="form-label">Tipo de Identificaci칩n del Sujeto</label>
            <select id="tipoIdentificacionSujeto" class="form-select" formControlName="tipoIdentificacionSujeto">
              <option [ngValue]="null" disabled selected>Seleccione un tipo</option>
              <option *ngFor="let item of arrayTipoIdentificacion" [ngValue]="item">
                {{ item.descripcion }}
              </option>
            </select>
            <div *ngIf="isInvalid('tipoIdentificacionSujeto')" class="text-danger small mt-1">
              Escoga un tipo de identificaci칩n
            </div>
          </div>

          <!-- Identificaci칩n del Sujeto -->
          <div class="col-md-6">
            <label for="identificacionSujeto" class="form-label">Identificaci칩n del Sujeto</label>
            <input type="text" id="identificacionSujeto" class="form-control" formControlName="identificacionSujeto" maxlength="13" />
            <div *ngIf="isInvalid('identificacionSujeto')" class="text-danger small mt-1">
              La identificaci칩n es obligatoria
            </div>
          </div>

          <!-- N칰mero de Operaci칩n -->
          <div class="col-md-6">
            <label for="numeroOperacion" class="form-label">N칰mero de Operaci칩n</label>
            <input type="text" id="numeroOperacion" class="form-control" formControlName="numeroOperacion" maxlength="32" />
            <div *ngIf="isInvalid('numeroOperacion')" class="text-danger small mt-1">
              El n칰mero de operaci칩n es obligatorio
            </div>
          </div>

          <!-- N칰mero de Garant칤a -->
          <div class="col-md-6">
            <label for="numeroGarantia" class="form-label">N칰mero de Garant칤a</label>
            <input type="text" id="numeroGarantia" class="form-control" formControlName="numeroGarantia" maxlength="32" />
            <div *ngIf="isInvalid('numeroGarantia')" class="text-danger small mt-1">
              El n칰mero de garant칤a es obligatorio
            </div>
          </div>
        </div>

        <!-- Secci칩n: Informaci칩n de la Garant칤a -->
        <h5 class="mt-4 mb-2 border-bottom pb-1">Informaci칩n de la Garant칤a</h5>
        <div class="row g-3">

          <!-- Tipo de Garant칤a -->
          <div class="col-md-6">
            <label for="tipoGarantia" class="form-label">Tipo de Garant칤a</label>
            <select id="tipoGarantia" class="form-select" formControlName="tipoGarantia">
              <option [ngValue]="null" disabled selected>Seleccione un tipo</option>
              <option *ngFor="let item of arrayTipoGarantia" [ngValue]="item">
                {{ item.descripcion }}
              </option>
            </select>
            <div *ngIf="isInvalid('tipoGarantia')" class="text-danger small mt-1">
              El tipo de garant칤a es obligatorio
            </div>
          </div>

          <!-- Descripci칩n de la Garant칤a -->
          <div class="col-md-6">
            <label for="descripcionGarantia" class="form-label">Descripci칩n de la Garant칤a</label>
            <input type="text" id="descripcionGarantia" class="form-control" formControlName="descripcionGarantia" maxlength="120" />
            <div *ngIf="isInvalid('descripcionGarantia')" class="text-danger small mt-1">
              La descripci칩n es obligatoria
            </div>
          </div>

          <!-- Ubicaci칩n de la Garant칤a (Pa칤s) -->
          <div class="col-md-4">
            <label for="ubicacionGarantiaPais" class="form-label">Ubicaci칩n de la Garant칤a (Pa칤s)</label>
            <select id="ubicacionGarantiaPais" class="form-select" formControlName="ubicacionGarantiaPais" (change)="onPaisChange()">
              <option [ngValue]="null" disabled selected>Seleccione un pa칤s</option>
              <option *ngFor="let item of arrayUbicacionPais" [ngValue]="item">
                {{ item.descripcion }}
              </option>
            </select>
            <div *ngIf="isInvalid('ubicacionGarantiaPais')" class="text-danger small mt-1">
              El pa칤s es obligatorio
            </div>
          </div>

          <!-- Ubicaci칩n de la Garant칤a (Provincia) -->
          <div class="col-md-4">
            <label for="ubicacionGarantiaProvincia" class="form-label">Ubicaci칩n de la Garant칤a (Provincia)</label>
            <select id="ubicacionGarantiaProvincia" class="form-select" formControlName="ubicacionGarantiaProvincia">
              <option [ngValue]="null" disabled selected>Seleccione una provincia</option>
              <option *ngFor="let item of arrayUbicacionProvincia" [ngValue]="item">
                {{ item.descripcion }}
              </option>
            </select>
          </div>

          <!-- Ubicaci칩n de la Garant칤a (Cant칩n) -->
          <div class="col-md-4">
            <label for="ubicacionGarantiaCanton" class="form-label">Ubicaci칩n de la Garant칤a (Cant칩n)</label>
            <select id="ubicacionGarantiaCanton" class="form-select" formControlName="ubicacionGarantiaCanton">
              <option [ngValue]="null" disabled selected>Seleccione un cant칩n</option>
              <option *ngFor="let item of arrayUbicacionCanton" [ngValue]="item">
                {{ item.descripcion }}
              </option>
            </select>
          </div>
        </div>

        <h5 class="mt-4 mb-2 border-bottom pb-1">Valores y Fechas</h5>
        <div class="row g-3">

          <!-- Valor del Aval칰o / T칤tulo -->
          <div class="col-md-6">
            <label for="valorAvaluoTitulo" class="form-label">Valor del Aval칰o / T칤tulo</label>
            <input type="number" id="valorAvaluoTitulo" class="form-control" formControlName="valorAvaluoTitulo" step="0.01" min="0" />
            <div *ngIf="isInvalid('valorAvaluoTitulo')" class="text-danger small mt-1">
              Ingrese un valor v치lido (mayor a 0)
            </div>
          </div>

          <!-- Fecha del Aval칰o -->
          <div class="col-md-6">
            <label for="fechaAvaluo" class="form-label">Fecha del Aval칰o</label>
            <input type="date" id="fechaAvaluo" class="form-control" formControlName="fechaAvaluo" />
            <div *ngIf="isInvalid('fechaAvaluo')" class="text-danger small mt-1">
              La fecha de aval칰o es obligatoria
            </div>
          </div>

          <!-- N칰mero de Registro de la Garant칤a -->
          <div class="col-md-6">
            <label for="numeroRegistroGarantia" class="form-label">N칰mero de Registro de la Garant칤a</label>
            <input type="text" id="numeroRegistroGarantia" class="form-control" formControlName="numeroRegistroGarantia" maxlength="20" />
          </div>

          <!-- Fecha de Contabilizaci칩n de la Garant칤a -->
          <div class="col-md-6">
            <label for="fechaContabilizacionGarantia" class="form-label">Fecha de Contabilizaci칩n de la Garant칤a</label>
            <input type="date" id="fechaContabilizacionGarantia" class="form-control" formControlName="fechaContabilizacionGarantia" />
            <div *ngIf="isInvalid('fechaContabilizacionGarantia')" class="text-danger small mt-1">
              La fecha de contabilizaci칩n es obligatoria
            </div>
          </div>

          <!-- Porcentaje que Cubre la Garant칤a -->
          <div class="col-md-6">
            <label for="porcentajeCubreGarantia" class="form-label">Porcentaje que Cubre la Garant칤a</label>
            <input type="number" id="porcentajeCubreGarantia" class="form-control" formControlName="porcentajeCubreGarantia" step="0.01" min="0" max="100" />
            <div *ngIf="isInvalid('porcentajeCubreGarantia')" class="text-danger small mt-1">
              Ingrese un porcentaje v치lido (0-100)
            </div>
          </div>

          <!-- Estado del Registro -->
          <div class="col-md-6">
            <label for="estadoRegistro" class="form-label">Estado del Registro</label>
            <select id="estadoRegistro" class="form-select" formControlName="estadoRegistro">
              <option [ngValue]="null" disabled selected>Seleccione un estado</option>
              <option *ngFor="let item of arrayEstadoRegistro" [ngValue]="item">
                {{ item.descripcion }}
              </option>
            </select>
            <div *ngIf="isInvalid('estadoRegistro')" class="text-danger small mt-1">
              El estado del registro es obligatorio
            </div>
          </div>
        </div>
      </form>
    </div>

    <!-- Footer -->
    <div class="modal-footer">
      <button type="submit" class="btn btn-primary" [disabled]="r07Form.invalid" (click)="onSubmit()">
        <i class="bi bi-check"></i> Guardar Registro
      </button>
      <button type="button" (click)="closeModal()" class="btn btn-secondary">
        <i class="bi bi-x"></i> Cancelar
      </button>
    </div>

  </div>
</div>