<div class="card">
  <div class="card-header d-flex justify-content-between align-items-center">
    <h3>Tendencias de Riesgo</h3>
    <div class="btn-group">
      <button class="btn btn-outline-primary" 
              [class.active]="selectedPeriod === 'daily'"
              (click)="onPeriodChange('daily')">
        Diario
      </button>
      <button class="btn btn-outline-primary" 
              [class.active]="selectedPeriod === 'weekly'"
              (click)="onPeriodChange('weekly')">
        Semanal
      </button>
      <button class="btn btn-outline-primary" 
              [class.active]="selectedPeriod === 'monthly'"
              (click)="onPeriodChange('monthly')">
        Mensual
      </button>
    </div>
  </div>
  <div class="card-body">
    <div class="chart-container">
      <canvas id="trendsChart"></canvas>
    </div>
    <div class="trend-summary mt-4">
      <div class="row">
        <div *ngFor="let trend of trends" class="col-md-4">
          <div class="trend-card">
            <h4>{{ trend.metricName }} ({{ trend.category }})</h4>
            <div class="trend-value">
              Valor: {{ trend.currentValue | number:'1.2-2' }}
            </div>
            <div *ngIf="trend.previousValue !== undefined" class="trend-previous-value">
              Anterior: {{ trend.previousValue | number:'1.2-2' }}
            </div>
            <div *ngIf="trend.change !== undefined" class="trend-change" [ngClass]="trend.change >= 0 ? 'positive' : 'negative'">
              Cambio: {{ trend.change >= 0 ? '+' : '' }}{{ trend.change | number:'1.2-2' }}
            </div>
            <div class="trend-direction" [ngClass]="getTrendDirectionClass(trend.direction)">
              <i class="pi" [ngClass]="{
                'pi-arrow-up': trend.direction === 'IMPROVING',
                'pi-arrow-down': trend.direction === 'DECLINING',
                'pi-minus': trend.direction === 'STABLE'
              }"></i>
              {{ trend.direction | titlecase }}
            </div>
            <p *ngIf="trend.description" class="trend-description">{{ trend.description }}</p>
            <div class="trend-dates">
              <small>Periodo: {{ trend.timePeriod }} - {{ trend.trendDate | date:'shortDate' }}</small>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div> 
