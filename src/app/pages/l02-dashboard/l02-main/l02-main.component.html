<div class="l02-main-container">
  <!-- CABECERA -->
  <div class="header">
    <h1>L02 - Portafolio de Inversiones</h1>
    <p class="subtitle">Se deber치 reportar 칰nicamente los nuevos t칤tulos que se hayan instrumentado cada mes. Cada t칤tulo debe reportarse una 칰nica vez en esta estructura, hasta que se lo venda o liquide.</p>
  </div>

  <!-- INFORMACI칍N DE ESTRUCTURA -->
  <div class="structure-info">
    <div class="card">
      <div class="card-header">
        <h3>游늶 Informaci칩n de la Estructura L02</h3>
      </div>
      <div class="card-content">
        <p><strong>Descripci칩n:</strong> Si un t칤tulo que sali칩 del portafolio de la entidad es adquirido o reingresado nuevamente en otro mes, debe volverse a reportar con la nueva fecha de compra. Si un t칤tulo es comprado y vendido dentro de un mismo mes y a la fecha de corte de la estructura el mismo ya no se encuentra en el portafolio de la entidad, dicho t칤tulo s칤 debe reportarse en esta estructura, as칤 como tambi칠n debe ser reportado en la estructura L03 como liquidaci칩n total.</p>
        <p><strong>Periodicidad:</strong> Mensual </p>
        <p><strong>Plazo entrega:</strong> Seg칰n requerimientos de la SB</p>
        <p><strong>C칩digo Banco:</strong> 1038</p>
        <p><strong>Formato archivo:</strong> l02Exxxxddmmaaaa.txt</p>
        <p><strong>Fuente:</strong> Manual de Control de Inversiones - SB Marzo 2017</p>
        
        <div class="requirements">
          <strong>Requisitos:</strong>
          <ul>
            <li>Estructura eventual (no mensual)</li>
            <li>4 campos oficiales obligatorios</li>
            <li>Formato TXT con separador tabulador</li>
            <li>Validaciones seg칰n manual SB</li>
          </ul>
        </div>

        <strong>Campos Oficiales:</strong>
          <div style="height: 400px;width: 100%;overflow: auto;border: 1px solid #ccc;background: #fff;">
            <app-l02-fields-table></app-l02-fields-table>
          </div>  
      </div>
    </div>
  </div>

  <!-- RESUMEN -->
  <div class="summary-section">
    <div class="card">
      <div class="card-header">
        <h3>游늵 Resumen del Reporte</h3>
      </div>
      <div class="card-content">
        <div class="summary-grid">
          <div class="summary-item">
            <label>Total Registros:</label>
            <span>{{ 20 }}</span>
          </div>
          <div class="summary-item">
            <label>Fecha Generaci칩n:</label>
            <span> 2025/08/20 </span>
          </div>
          <div class="summary-item">
            <label>Emisores:</label>
            <span>{{ 20 }}</span>
          </div>
          <div class="summary-item">
            <label>Custodios:</label>
            <span>{{ 20 }}</span>
          </div>
          <div class="summary-item">
            <label>Depositarios:</label>
            <span>{{ 20 }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="data-section">
    <div class="table-container">
      <table class="data-table">
        <thead>
          <tr>
            <th>
              Tipo de Identificaci칩n
            </th>
            <th>
              Emisor
            </th>
            <th>
              N칰mero de T칤tulo
            </th>
            <th>
              Fecha de emisi칩n
            </th>
            <th>
              Fecha de Vencimiento
            </th>
            <th>
              Instrumento
            </th>
            <th>
              Categor칤a de Instrumento
            </th>
            <th>
              Tipo de Instrumento
            </th>
            <th>
              Identificaci칩n de Instrumento
            </th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of arrayResume">
            <td class="data-cell">
              <span class="cell-value">{{ item.tipoIdentificacion.description }}</span>
            </td>
            <td class="data-cell">
              <span class="cell-value">{{ item.emisor.description }}</span>
            </td>
            <td class="data-cell">
              <span class="cell-value">{{ item.numeroTitulo }}</span>
            </td>
            <td class="data-cell">
              <span class="cell-value">{{ item.fechaEmision }}</span>
            </td>
            <td class="data-cell">
              <span class="cell-value">{{ item.fechaVencimiento }}</span>
            </td>
            <td class="data-cell">
              <span class="cell-value">{{ item.instrumento.description }}</span>
            </td>
            <td class="data-cell">
              <span class="cell-value">{{ item.categoriaInstrumento.description }}</span>
            </td>
            <td class="data-cell">
              <span class="cell-value">{{ item.tipoInstrumento.description }}</span>
            </td>
            <td class="data-cell">
              <span class="cell-value">{{ item.identificacionInstrumento }}</span>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div class="d-flex gap-2">
    <button (click)="validateAndGenerateReport()" [disabled]="loading" class="btn btn-primary">
      <i class="pi pi-check-circle"></i>
      {{ loading ? 'Validando...' : 'Validar y Generar Reporte L02' }}
    </button>

    <button (click)="exportToTxt()" class="btn btn-success">
      <i class="pi pi-download"></i>
      Exportar TXT
    </button>

    <button (click)="openModal()" class="btn btn-info">
      <i class="pi pi-plus"></i>
      Crear Nuevo Registro
    </button>
  </div>



  <app-l02-modal-form
    [isVisible]="showModalForm"
    (modalClosed)="onModalClosed()"></app-l02-modal-form>

  <div *ngIf="loading" class="loading-overlay">
    <div class="loading-spinner">
      <div class="spinner"></div>
      <p>Generando reporte L02...</p>
    </div>
  </div>
</div>
