<!-- ======================================== -->
<!-- TEMPLATE L01 - FRONTEND -->
<!-- ======================================== -->
<!-- Propósito: Vista para manejo de L01 -->
<!-- 
Autor: Christian Aguirre
Fecha: 2025-01-08
-->

<div class="l01-dashboard">
  <div class="header">
    <h2>Dashboard L01 - Emisores, Custodios y Depositarios</h2>
    <div class="actions">
      <button (click)="exportReport()" class="btn-export">Exportar Reporte</button>
      <button (click)="refreshData()" class="btn-refresh">Actualizar</button>
    </div>
  </div>

  <!-- Filtros -->
  <div class="filters">
    <div class="filter-group">
      <label>Tipo Identificación:</label>
      <select [(ngModel)]="filters.tipoIdentificacion" (change)="applyFilters()">
        <option value="">Todos</option>
        <option value="R">Ecuador (R)</option>
        <option value="X">Extranjero (X)</option>
      </select>
    </div>
    <div class="filter-group">
      <label>Clasificación:</label>
      <select [(ngModel)]="filters.clasificacion" (change)="applyFilters()">
        <option value="">Todas</option>
        <option value="1">Clasificación 1</option>
        <option value="2">Clasificación 2</option>
      </select>
    </div>
    <div class="filter-group">
      <label>Tipo Emisor:</label>
      <select [(ngModel)]="filters.tipoEmisor" (change)="applyFilters()">
        <option value="">Todos</option>
        <option value="1">Tipo 1</option>
        <option value="2">Tipo 2</option>
      </select>
    </div>
    <div class="filter-group">
      <label>Buscar:</label>
      <input type="text" [(ngModel)]="searchTerm" (input)="applySearch()" placeholder="Buscar por identificación...">
    </div>
  </div>

  <!-- KPIs -->
  <div class="kpi-cards">
    <div class="kpi-card">
      <h3>Total Registros</h3>
      <p class="kpi-value">{{ totalRegistros }}</p>
    </div>
    <div class="kpi-card">
      <h3>Emisores Ecuador</h3>
      <p class="kpi-value">{{ emisoresEcuador }}</p>
    </div>
    <div class="kpi-card">
      <h3>Emisores Extranjeros</h3>
      <p class="kpi-value">{{ emisoresExtranjeros }}</p>
    </div>
    <div class="kpi-card">
      <h3>Nuevos este Mes</h3>
      <p class="kpi-value">{{ nuevosEsteMes }}</p>
    </div>
  </div>

  <!-- Tabla de Datos -->
  <div class="data-section">
    <h3>Datos L01 - Emisores, Custodios y Depositarios</h3>
    <div class="table-container">
      <table>
        <thead>
          <tr>
            <th>ID</th>
            <th>Tipo Identificación</th>
            <th>Identificación</th>
            <th>Clasificación</th>
            <th>Tipo Emisor</th>
            <th>Fecha Creación</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of filteredData">
            <td>{{ item.id }}</td>
            <td>{{ getTipoIdentificacionLabel(item.tipoIdentificacion) }}</td>
            <td>{{ item.identificacion }}</td>
            <td>{{ getClasificacionLabel(item.clasificacion) }}</td>
            <td>{{ getTipoEmisorLabel(item.tipoEmisor) }}</td>
            <td>{{ item.fechaCreacion | date:'dd/MM/yyyy' }}</td>
            <td>
              <button (click)="editItem(item)" class="btn-edit">Editar</button>
              <button (click)="deleteItem(item.id!)" class="btn-delete">Eliminar</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Loading y Error -->
  <div *ngIf="loading" class="loading">
    <p>Cargando datos...</p>
  </div>
  
  <div *ngIf="error" class="error">
    <p>{{ error }}</p>
    <button (click)="clearError()" class="btn-clear">Cerrar</button>
  </div>
</div>
