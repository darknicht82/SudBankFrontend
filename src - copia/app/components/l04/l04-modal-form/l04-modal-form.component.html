<!-- Modal del Formulario L04 -->
<div class="modal-overlay" *ngIf="isVisible" (click)="closeModal()">
  <div class="modal" (click)="$event.stopPropagation()">
    
    <!-- Header -->
    <div class="modal-header">
      <div class="header-content">
        <span class="operation-icon">📝</span>
        <h3 class="modal-title">Crear Nuevo Registro L04</h3>
      </div>
      <button class="close-button" (click)="closeModal()" type="button">
        <span>&times;</span>
      </button>
    </div>

    <!-- Body -->
    <div class="modal-body">
      <form [formGroup]="l04Form" (ngSubmit)="onSubmit()" class="w-100">

        <!-- Sección: Título -->
        <h5 class="mt-3 mb-2 border-bottom pb-1">Título</h5>
        <div class="row g-2">
          <!-- Tipo Identificación -->
          <div class="col-md-6">
            <label for="tipoIdentificacion" class="form-label">Tipo de Identificación</label>
            <select 
              id="tipoIdentificacion" 
              class="form-select"
              formControlName="tipoIdentificacion">
              <option [ngValue]="null" disabled selected>Seleccione un tipo</option>
              <option *ngFor="let item of arrayTipoIdentificacion" [ngValue]="item">
                {{ item.descripcion }}
              </option>
            </select>
            <div *ngIf="isInvalid('tipoIdentificacion')" class="text-danger small mt-1">
              Escoga un tipo de identificación
            </div>
          </div>

          <!-- identificacionEmisor -->
          <div class="col-md-6">
            <label for="identificacionEmisor" class="form-label">Identificación del emisor</label>
            <select 
              id="identificacionEmisor" 
              class="form-select"
              formControlName="identificacionEmisor">
              <option [ngValue]="null" disabled selected>Seleccione una identificación</option>
              <option *ngFor="let item of arrayIdentificacionEmisor" [ngValue]="item">
                {{ item.descripcion }}
              </option>
            </select>
            <div *ngIf="isInvalid('identificacionEmisor')" class="text-danger small mt-1">
              La identificación es obligatoria
            </div>
          </div>

          <!-- numeroTitulo -->
          <div class="col-md-6">
            <label for="numeroTitulo" class="form-label">Número de título</label>
            <input type="text" id="numeroTitulo" class="form-control" formControlName="numeroTitulo" />
            <div *ngIf="isInvalid('numeroTitulo')" class="text-danger small mt-1">
              El número de título es obligatorio
            </div>
          </div>

          <!-- Fecha de Emisión -->
          <div class="col-md-6">
            <label for="fechaEmision" class="form-label">Fecha de Emisión</label>
            <input type="date" id="fechaEmision" class="form-control" formControlName="fechaEmision" />
            <div *ngIf="isInvalid('fechaEmision')" class="text-danger small mt-1">
              La fecha de emisión es obligatoria
            </div>
          </div>

          <!-- Fecha de Compra -->
          <div class="col-md-6">
            <label for="fechaCompra" class="form-label">Fecha de Compra</label>
            <input type="date" id="fechaCompra" class="form-control" formControlName="fechaCompra" />
            <div *ngIf="isInvalid('fechaCompra')" class="text-danger small mt-1">
              La fecha de compra es obligatoria
            </div>
          </div>

          <!-- Fecha de transferencia -->
          <div class="col-md-6">
            <label for="fechaTransferencia" class="form-label">Fecha de Transferencia</label>
            <input type="date" id="fechaTransferencia" class="form-control" formControlName="fechaTransferencia" />
            <div *ngIf="isInvalid('fechaTransferencia')" class="text-danger small mt-1">
              La fecha de transferencia es obligatoria
            </div>
          </div>
        </div>

        <!-- Sección: Instrumento -->
        <h5 class="mt-4 mb-2 border-bottom pb-1">Valores</h5>
        <div class="row g-3">

          <!-- Motivo de Transferencia -->
          <div class="col-md-6">
            <label for="motivoTransferencia" class="form-label">Motivo de Transferencia</label>
            <select 
              id="motivoTransferencia" 
              class="form-select"
              formControlName="motivoTransferencia">
              <option [ngValue]="null" disabled selected>Seleccione un motivo</option>
              <option *ngFor="let item of arrayMotivoTransferencia" [ngValue]="item">
                {{ item.descripcion }}
              </option>
            </select>
            <div *ngIf="isInvalid('motivoTransferencia')" class="text-danger small mt-1">
              El motivo de transferencia es obligatorio
            </div>
          </div>

          <div class="col-md-6">
            <label for="cuentaOrigen" class="form-label">Cuenta de Origen</label>
            <input type="number" id="cuentaOrigen" class="form-control" formControlName="cuentaOrigen" />
            <div *ngIf="isInvalid('cuentaOrigen')" class="text-danger small mt-1">
              La cuenta de origen es obligatorio
            </div>
          </div>

          <div class="col-md-6">
            <label for="cuentaDestino" class="form-label">Cuenta de Destino</label>
            <input type="number" id="cuentaDestino" class="form-control" formControlName="cuentaDestino" />
            <div *ngIf="isInvalid('cuentaDestino')" class="text-danger small mt-1">
              La cuenta de destino es obligatorio
            </div>
          </div>
          
          <div class="col-md-6">
            <label for="valorLibrosCuentaOrigen" class="form-label">Valor en libros en dólares cuenta origen</label>
            <input type="number" id="valorLibrosCuentaOrigen" class="form-control" formControlName="valorLibrosCuentaOrigen" />
            <div *ngIf="isInvalid('valorLibrosCuentaOrigen')" class="text-danger small mt-1">
              El valor en libros de la cuenta de origen es obligatorio
            </div>
          </div>

          <div class="col-md-6">
            <label for="valorLibrosCuentaDestino" class="form-label">Valor en libros en dólares cuenta destino</label>
            <input type="number" id="valorLibrosCuentaDestino" class="form-control" formControlName="valorLibrosCuentaDestino" />
            <div *ngIf="isInvalid('valorLibrosCuentaDestino')" class="text-danger small mt-1">
              El valor en libros de la cuenta de destino es obligatorio
            </div>
          </div>
        </div>
      </form>
    </div>

    <!-- Footer -->
    <div class="modal-footer">
      <button type="submit" class="btn btn-primary" [disabled]="l04Form.invalid" (click)="onSubmit()">
        <i class="bi bi-check"></i> Guardar Registro
      </button>
      <button type="button" (click)="closeModal()" class="btn btn-secondary">
        <i class="bi bi-x"></i> Cancelar
      </button>
    </div>

  </div>
</div>